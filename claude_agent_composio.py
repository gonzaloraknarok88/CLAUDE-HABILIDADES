"""\nCLAUDE AGENT CON COMPOSIO - TODAS LAS FUNCIONALIDADES\nAgente de IA con acceso a +1000 herramientas y servicios\nConfiguraci√≥n lista para usar\n\nCreado por: Gonzalo Raknarok\nRepositorio: CLAUDE-HABILIDADES\n\"""\n\nimport asyncio\nimport os\nfrom composio import Composio\nfrom composio_claude_agent_sdk import ClaudeAgentSDKProvider\nfrom claude_agent_sdk import ClaudeSDKClient, ClaudeAgentOptions, create_sdk_mcp_server\n\n# ============================================\n# CONFIGURACI√ìN - MODIFICA AQU√ç TUS CREDENCIALES\n# ============================================\n\n# Tu API Key de Composio (obt√©n una gratis en: https://platform.composio.dev)\nCOMPOSIO_API_KEY = "tu_api_key_aqui"  # CAMBIA ESTO\n\n# ID √∫nico para tu usuario (puede ser cualquier string √∫nico)\nUSER_ID = "gonzalo_workspace_user_001"\n\n# ============================================\n# CONFIGURACI√ìN DE TOOLKITS\n# ============================================\n\n# Lista de todas las herramientas disponibles\n# Puedes activar/desactivar las que necesites\nTOOLKITS_DISPONIBLES = {\n    # Comunicaci√≥n\n    "gmail": True,          # Enviar/leer emails\n    "slack": True,          # Mensajer√≠a empresarial\n    "discord": True,        # Comunidades y chats\n    "telegram": True,       # Mensajer√≠a instant√°nea\n    \n    # Desarrollo\n    "github": True,         # Control de versiones\n    "gitlab": True,         # Repositorios\n    "linear": True,         # Gesti√≥n de proyectos\n    "jira": True,           # Seguimiento de issues\n    \n    # Productividad\n    "notion": True,         # Base de conocimientos\n    "googledrive": True,   # Almacenamiento en la nube\n    "dropbox": True,        # Archivos\n    "airtable": True,       # Bases de datos\n    \n    # CRM y Ventas\n    "hubspot": True,        # CRM\n    "salesforce": True,    # Gesti√≥n de clientes\n    "pipedrive": True,      # Pipeline de ventas\n    \n    # Dise√±o\n    "figma": True,          # Dise√±o colaborativo\n    "canva": True,          # Creaci√≥n de contenido\n    "abstract": True,       # Colaboraci√≥n en dise√±o\n    \n    # Datos y Analytics\n    "googlesheets": True,  # Hojas de c√°lculo\n    "postgresql": False,   # Base de datos (requiere config)\n    "mysql": False,        # Base de datos (requiere config)\n    \n    # Automatizaci√≥n\n    "ably": True,          # Mensajer√≠a en tiempo real\n    "zapier": True,        # Conectar apps\n    "make": True,          # Automatizaci√≥n\n}\n\n# ============================================\n# CLASE PRINCIPAL DEL AGENTE\n# ============================================\n\nclass ClaudeAgentComposio:\n    def __init__(self, api_key: str, user_id: str):\n        \"\"\"\n        Inicializa el agente de Claude con Composio\n        \n        Args:\n            api_key: Tu API key de Composio\n            user_id: ID √∫nico para el usuario\n        \"\"\"\n        self.api_key = api_key\n        self.user_id = user_id\n        self.composio = None\n        self.session = None\n        self.tools = None\n        self.server = None\n        \n    def inicializar(self):\n        \"\"\"Inicializa Composio y crea la sesi√≥n del usuario\"\"\"\n        print(\"üöÄ Inicializando Composio...\")\n        \n        # Inicializar Composio con el provider de Claude\n        self.composio = Composio(\n            api_key=self.api_key,\n            provider=ClaudeAgentSDKProvider()\n        )\n        \n        print(f\"‚úÖ Composio inicializado para usuario: {self.user_id}\")\n        \n        # Crear sesi√≥n de Tool Router\n        self.session = self.composio.create(\n            user_id=self.user_id,\n            manage_connections=True  # Permite autorizar apps en el chat\n        )\n        \n        print(\"‚úÖ Sesi√≥n de Tool Router creada\")\n        \n        # Obtener todas las herramientas\n        self.tools = self.session.tools()\n        \n        print(f\"‚úÖ {len(self.tools) if hasattr(self.tools, '__len__') else 'M√∫ltiples'} herramientas cargadas\")\n        \n        # Crear servidor MCP personalizado\n        self.server = create_sdk_mcp_server(\n            name=\"composio_claude_agent\",\n            version=\"1.0.0\",\n            tools=self.tools\n        )\n        \n        print(\"‚úÖ Servidor MCP configurado\")\n        print(\"\\n" + \"="*60)\n        print(\"üéâ AGENTE CLAUDE LISTO PARA USAR\")\n        print(\"="*60 + \"\\n\")\n        \n    async def ejecutar_consulta(self, prompt: str):\n        \"\"\"\n        Ejecuta una consulta al agente de Claude\n        \n        Args:\n            prompt: La consulta o instrucci√≥n para Claude\n        \"\"\"\n        print(f\"\\nüí¨ Usuario: {prompt}\\n\")\n        print(\"ü§ñ Claude est√° procesando...\\n\")\n        \n        # Configurar opciones del agente\n        options = ClaudeAgentOptions(\n            system_prompt=\"\"\"\n            Eres un asistente de IA extremadamente capaz con acceso a m√°s de 1000 herramientas y servicios.\n            Puedes ayudar con:\n            - Enviar y leer emails (Gmail)\n            - Gestionar c√≥digo en GitHub\n            - Crear y editar documentos (Notion, Google Drive)\n            - Enviar mensajes (Slack, Discord, Telegram)\n            - Gestionar proyectos (Linear, Jira)\n            - Automatizar tareas\n            - Trabajar con bases de datos\n            - Crear dise√±os (Figma, Canva)\n            - Y mucho m√°s\n            \n            Siempre confirma antes de realizar acciones que modifiquen datos.\n            S√© proactivo y sugiere soluciones cuando sea apropiado.\n            \"\",\n            permission_mode=\"bypassPermissions\",  # O \"requirePermissions\" para mayor seguridad\n            mcp_servers={\n                \"composio\": self.server\n            }\n        )\n        \n        # Ejecutar la consulta\n        async with ClaudeSDKClient(options=options) as client:\n            await client.query(prompt)\n            \n            # Recibir y mostrar respuesta\n            async for msg in client.receive_response():\n                print(msg)\n\n    def conectar_app(self, app_name: str):\n        \"\"\"\n        Conecta una aplicaci√≥n manualmente\n        \n        Args:\n            app_name: Nombre de la app (ej: \"gmail\", \"github\")\n        \"\"\"\n        print(f\"\\nüîó Conectando {app_name}...\")\n        \n        connection_request = self.session.authorize(\n            toolkit=app_name,\n            callback_url='http://localhost:8000/callback'\n        )\n        \n        print(f\"\\nüìã Por favor, autoriza la app visitando esta URL:\")\n        print(f\"üåê {connection_request.redirect_url}\\n\")\n        \n        # Esperar a que el usuario autorice\n        print(\"‚è≥ Esperando autorizaci√≥n...\")\n        connected_account = connection_request.wait_for_connection()\n        \n        print(f\"‚úÖ ¬°{app_name} conectado exitosamente!\")\n        print(f\"üìå ID de cuenta: {connected_account.id}\\n\")\n        \n        return connected_account\n\n# ============================================\n# FUNCI√ìN PRINCIPAL\n# ============================================\n\nasync def main():\n    \"\"\"Funci√≥n principal para ejecutar el agente\"\"\"\n    \n    # Verificar que se configur√≥ la API key\n    if COMPOSIO_API_KEY == \"tu_api_key_aqui\":\n        print(\"\\n‚ö†Ô∏è  ERROR: Debes configurar tu COMPOSIO_API_KEY\")\n        print(\"\\nüìù Pasos para obtener tu API key:\")\n        print(\"1. Ve a https://platform.composio.dev\")\n        print(\"2. Reg√≠strate o inicia sesi√≥n\")\n        print(\"3. Ve a Settings ‚Üí API Keys\")\n        print(\"4. Genera una nueva API key\")\n        print(\"5. Copia la key y p√©gala en este archivo\\n\")\n        return\n    \n    # Crear el agente\n    agente = ClaudeAgentComposio(\n        api_key=COMPOSIO_API_KEY,\n        user_id=USER_ID\n    )\n    \n    # Inicializar\n    agente.inicializar()\n    \n    # ============================================\n    # EJEMPLOS DE USO\n    # ============================================\n    \n    print(\"\\nüìö EJEMPLOS DE LO QUE PUEDES HACER:\\n\")\n    print(\"1. Enviar un email:\")\n    print(\"   'Env√≠a un email a juan@ejemplo.com con asunto Test y cuerpo Hola mundo'\\n\")\n    \n    print(\"2. Crear un issue en GitHub:\")\n    print(\"   'Crea un issue en mi repositorio CLAUDE-HABILIDADES con t√≠tulo Bug Fix'\\n\")\n    \n    print(\"3. Buscar archivos en Google Drive:\")\n    print(\"   'Busca todos los PDFs en mi Google Drive que contengan \\\"reporte\\\"'\\n\")\n    \n    print(\"4. Enviar mensaje en Slack:\")\n    print(\"   'Env√≠a un mensaje al canal #general diciendo Hola equipo'\\n\")\n    \n    print(\"5. Consultar datos:\")\n    print(\"   '¬øCu√°ntos emails sin leer tengo en Gmail?'\\n\")\n    \n    print(\"="*60)\n    \n    # Ejemplo de consulta\n    print(\"\\nüéØ Ejecutando consulta de ejemplo...\\n\")\n    \n    await agente.ejecutar_consulta(\n        \"Hola! Soy tu asistente de Composio. ¬øEn qu√© puedo ayudarte hoy? \" \n        \"Tengo acceso a Gmail, GitHub, Slack, Notion y muchas otras herramientas.\"\n    )\n    \n    # ============================================\n    # MODO INTERACTIVO (Opcional)\n    # ============================================\n    \n    print(\"\\nüí° Para usar el agente interactivamente, descomenta el c√≥digo abajo\\n\")\n    \n    # Descomentar para modo interactivo:\n    # while True:\n    #     try:\n    #         consulta = input(\"\\nüó£Ô∏è  T√∫: \")\n    #         if consulta.lower() in ['salir', 'exit', 'quit']:\n    #             print(\"üëã ¬°Hasta luego!\")\n    #             break\n    #         \n    #         await agente.ejecutar_consulta(consulta)\n    #     \n    #     except KeyboardInterrupt:\n    #         print(\"\\n\\nüëã ¬°Hasta luego!\")\n    #         break\n\n# ============================================\n# PUNTO DE ENTRADA\n# ============================================\n\nif __name__ == \"__main__\":\n    print(\"\\n" + \"="*60)\n    print(\"ü§ñ CLAUDE AGENT CON COMPOSIO\")\n    print(\"üîß Todas las funcionalidades integradas\")\n    print(\"üì¶ +1000 herramientas disponibles\")\n    print(\"="*60)\n    \n    # Ejecutar el agente\n    asyncio.run(main())\n
